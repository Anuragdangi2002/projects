<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Abandoned Places</title>
  <style>
    /* Reset & base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }
    body {
      background-color: #f4f4f4;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      background-color: #222;
      color: white;
      width: 100%;
      height: 150px;
      padding: 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      max-width: 100%;
    }
    header h1 {
      position: relative;
  z-index: 2;
  font-size: 30em;
  letter-spacing: 10px;
  text-transform: uppercase;
  text-decoration-line: none;

    }
    .search-bar input {
      padding: 10px;
      border-radius: 4px;
      border: none;
      outline: none;
      width: 500px;
    }
    button, .upload-button {
      background-color: #ff5c5c;
      padding: 10px 15px;
      color: white;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
      font-weight: bold;
      text-decoration: none;
      display: inline-block;
    }
    button:hover, .upload-button:hover {
      background-color: #e64545;
    }
    main {
      width: 100%;
      max-width: 1200px;
      flex-grow: 1;
      padding: 20px;
    }
    .posts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
      gap: 20px;
    }
    .post-card {
      width: 250px;
      height: 300px;
      background-size: cover;
      background-position: center;
      border-radius: 15px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      transition: transform 0.3s ease;
      cursor: pointer;
    }
    .post-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .post-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .post-info {
      padding: 15px;
    }
    .post-info h3 {
      margin-bottom: 10px;
    }
    .user-info {
      position:absolute;
      bottom: 0;
      width: 15%;
      color: #fff;
      display:flex;
      align-items: center;
      padding: 0px;
      padding-bottom: 10px;
    }
    .user-pic {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      border: 2px solid white;
    }
    /* Sections - only one active */
    section {
      display: none;
    }
    section.active {
      display: block;
    }
    /* Post Detail Styles */
    #postDetailSection img#detailImage {
      width: 100%;
      max-height: 100%;
      object-fit:fill;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    #postDetailSection {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    #postDetailSection h2 {
      margin-bottom: 10px;
    }
    #postDetailSection p {
      margin-bottom: 15px;
      line-height: 1.5;
    }
    #postDetailSection .user-info {
      margin-bottom: 15px;
      height: 15px;
      width: 15px;
      position:relative;
      margin: 10px;
      padding-left: 0px;
      color: #333;
      margin-left: 0px;
    }
    #postDetailSection a#detailMapLink {
      display: inline-block;
      background: #ff5c5c;
      color: white;
      padding: 8px 12px;
      border-radius: 5px;
      text-decoration: none;
      font-weight: bold;
      margin-bottom: 15px;
    }
    /* Comments */
    #commentsList {
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 15px;
      border-top: 1px solid #ddd;
      padding-top: 10px;
    }
    #commentsList .comment {
      background: #eee;
      padding: 8px 12px;
      border-radius: 6px;
      margin-bottom: 8px;
      word-wrap: break-word;
    }
    #commentInput {
      width: 100%;
      padding: 8px;
      margin-bottom: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      outline: none;
      font-size: 14px;
    }
    /* Upload & Profile forms */
    form {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: 0 auto;
    }
    form label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      margin-top: 15px;
    }
    form input[type="text"],
    form textarea,
    form input[type="url"],
    form input[type="file"] {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
      outline: none;
    }
    form textarea {
      resize: vertical;
      min-height: 80px;
    }
    form input[type="file"] {
      padding: 3px;
    }
    #imagePreview, #profilePicPreview {
      margin-top: 10px;
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 50%;
      display: none;
      border: 2px solid #ff5c5c;
    }
    /* Buttons container */
    .form-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    /* Navigation buttons */
    #homeBtn {
      background: transparent;
      border: none;
      color: white;
      font-size: 25px;
      cursor: pointer;
      text-decoration: none;
    }

    #goToUpload {
      background:#e64545;
      border: none;
      color: white;
      font-size: 15px;
      cursor: pointer;
      font-weight: bold;
      text-decoration: none;
    }

    /* Responsive */
    @media (max-width: 700px) {
      .posts-grid {
        grid-template-columns: 1fr;
      }
      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      .search-bar input {
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1 id="homeBtn" title="Go Home">ABANDONED PLACES</h1>
    <div class="search-bar" id="searchBar">
      <input type="text" id="searchInput" placeholder="Search places..." />
    </div>
    <button id="goToUpload">+ Post a Place</button>
  </header>

  <main>
    <!-- MAIN POSTS GRID -->
    <section id="mainSection" class="active">
      <div class="posts-grid" id="postsGrid">
        <!-- Posts inserted by JS -->
      </div>
    </section>

    <!-- POST DETAIL -->
    <section id="postDetailSection">
      <button id="backToHomeFromDetail" style="margin-bottom:15px;">← Back</button>
      <img id="detailImage" src="" alt="Place Image" />
      <h2 id="detailTitle"></h2>
      <p id="detailDescription"></p>
      <div class="user-info">

        <img id="detailUserPic" class="user-pic" src="" alt="Uploader"/>
        
        <span id="detailUsername"></span>
      </div>
      <a href="#" target="_blank" id="detailMapLink">View Location on Map</a>

      <div id="commentsList"></div>
      <input type="text" id="commentInput" placeholder="Add a comment..." />
      <button id="postCommentBtn">Post Comment</button>
    </section>

    <!-- PROFILE COMPLETION -->
    <section id="profileSection">
      <h2>Complete Your Profile</h2>
      <form id="profileForm">
        <label for="usernameInput">Username:</label>
        <input type="text" id="usernameInput" name="username" placeholder="@yourname" required />

        <label for="profilePicInput">Profile Picture:</label>
        <input type="file" id="profilePicInput" accept="image/*" required />
        <img id="profilePicPreview" alt="Profile Preview" />

        <div class="form-buttons">
          <button type="submit">Save Profile</button>
          <button type="button" id="cancelProfileBtn" style="background:#aaa;">Cancel</button>
        </div>
      </form>
    </section>

    <!-- UPLOAD POST -->
    <section id="uploadSection">
      <h2>Upload New Place</h2>
      <form id="uploadForm">
        <label for="title">Place Title:</label>
        <input type="text" id="title" name="title" required />

        <label for="description">Description:</label>
        <textarea id="description" name="description" required></textarea>

        <label for="location">Google Maps Link (or coordinates):</label>
        <input type="url" id="location" name="location" placeholder="https://maps.google.com/?q=lat,lng" required />

        <label for="image">Place Image:</label>
        <input type="file" id="image" accept="image/*" required />
        <img id="imagePreview" alt="Image Preview" />

        <div class="form-buttons">
          <button type="submit">Post Place</button>
          <button type="button" id="cancelUploadBtn" style="background:#aaa;">Cancel</button>
        </div>
      </form>
    </section>
  </main>

  <script>
    // Data store: posts & current user profile
    const posts = [
      {
        id: 1,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },
      {
        id: 2,
        title: "Stepped Tanks of Hampi",
        description:
          "The ruins of Hampi, once a grand city in the Indian state of Karnataka, were once home to more than 250,000 people in the Vijayanagar Empire, and filled with Hindu temples. The abandoned city is now dotted with hundreds of individual ruins, home to countless architectural wonders.",
        image:
          "https://imgs.search.brave.com/tO_C7bLszH1jfC51FmHTQwgscfE62VTYwefPxl3sGPQ/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9pbWdz/LnNlYXJjaC5icmF2/ZS5jb20vLTFvcnhW/Qk9QX2hveXBuNndJ/Sk5kSnVFYVhTZERU/R2Q3V0dWM3J2TnY4/VS9yczpmaXQ6NTAw/OjA6MDowL2c6Y2Uv/YUhSMGNITTZMeTkx/Y0d4di9ZV1F1ZDJs/cmFXMWxaR2xoL0xt/OXlaeTkzYVd0cGNH/VmsvYVdFdlkyOXRi/Vzl1Y3k4ei9Mek5r/THpFMWRHaGZZMlZ1/L2RIVnllVjloY1hW/aFgyUjEvWTNSZmRH/OWZUV0ZvWVc1aC9k/bUZ0YVY5d2JHRjBa/bTl5L2JWOVFkWE5v/YTJGeVlXNXAvWDNO/MFpYQmZkMlZzYkN4/Zi9TR0Z0Y0dsZlNH/bHVaSFZmL2JXOXVk/VzFsYm5SelgwdGgv/Y201aGRHRnJZVjh6/TG1wdy9adw",
        userPic: "https://randomuser.me/api/portraits/women/44.jpg",
        username: "@Sonia",
        mapLink: "https://maps.app.goo.gl/r4anZbHtnL9o6yyAA",
        comments: ["Spooky vibes!", "Great photos!"],
      },
      {
        id: 3,
        title: "Oculus Tower, Italy",
        description:
          "Italy is known for its impressive buildings – but few would have an abandoned factory on their must-see list. Yet for Nakamura, who visited this former distillery in 2015 while on an Urbex trip exploring northern and central Italy, it was a magical sight. It's just a concrete industrial plant, yet somehow, Italian architects had built in some incredible design elements that made it so cool, she says. The factorys tower, and the cathedral-like vastness of its interiors, was especially impressive.",
        image:
          "https://imgs.search.brave.com/9zO2sQtuXAO9fo5IQUEq75Dykdbdp462Oxf2U3pjrx0/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9pbWdz/LnNlYXJjaC5icmF2/ZS5jb20vZkw5RjQz/Um1rZC1JcVozUVU2/ZG9DcjY0eEVqR1hS/QVJTZUtzei1ab2FZ/TS9yczpmaXQ6NTAw/OjA6MDowL2c6Y2Uv/YUhSMGNITTZMeTkw/YjNWeS9hWE50YldW/a2FXRXVhWFJoL2JH/bGhMbWwwTDJsekwy/bHQvWVdkbEwyMXBk/SFZ5THpFMi9NREJZ/TVRBd01GOWpiM05o/L1gzWmxaR1Z5WlY5/d2FYTmgvWHpJdE1q/OTNhV1E5T0RBdy9K/bWhsYVQwMU1EQW1a/bWwwL1BXTnZibk4w/Y21GcGJpd3gvSm1a/dGREMTNaV0p3",
        userPic: "https://randomuser.me/api/portraits/men/85.jpg",
        username: "@Sushil",
        mapLink: "https://maps.app.goo.gl/DFE4MiY3ZtfBTuiq7",
        comments: ["Creepy but fascinating!", "Would be careful if I visit."],
      },

      {
        id: 4,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 5,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 6,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 7,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 8,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 9,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

      {
        id: 10,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

       {
        id: 11,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },

       {
        id: 12,
        title: "Maunsell Forts",
        description:
          "An old mansion left to decay in the woods. Beautiful yet eerie.",
        image:
          "https://i.pinimg.com/736x/a8/d1/6a/a8d16af6563c62258ae584394846e493.jpg",
        userPic: "https://randomuser.me/api/portraits/men/32.jpg",
        username: "@Anurag",
        mapLink: "https://maps.app.goo.gl/PDf6qqd6yYkeS7qs6",
        comments: ["Amazing place!", "Would love to explore here someday."],
      },
    ];

    let currentUser = null; // Will hold { username, profilePicUrl }

    // DOM elements
    const postsGrid = document.getElementById("postsGrid");
    const mainSection = document.getElementById("mainSection");
    const postDetailSection = document.getElementById("postDetailSection");
    const uploadSection = document.getElementById("uploadSection");
    const profileSection = document.getElementById("profileSection");
    const searchInput = document.getElementById("searchInput");
    const searchBar = document.getElementById("searchBar");
    const homeBtn = document.getElementById("homeBtn");
    const goToUploadBtn = document.getElementById("goToUpload");
    const uploadForm = document.getElementById("uploadForm");
    const imageInput = document.getElementById("image");
    const imagePreview = document.getElementById("imagePreview");
    const profileForm = document.getElementById("profileForm");
    const usernameInput = document.getElementById("usernameInput");
    const profilePicInput = document.getElementById("profilePicInput");
    const profilePicPreview = document.getElementById("profilePicPreview");
    const cancelProfileBtn = document.getElementById("cancelProfileBtn");
    const cancelUploadBtn = document.getElementById("cancelUploadBtn");

    // Post detail elements
    const detailImage = document.getElementById("detailImage");
    const detailTitle = document.getElementById("detailTitle");
    const detailDescription = document.getElementById("detailDescription");
    const detailUserPic = document.getElementById("detailUserPic");
    const detailUsername = document.getElementById("detailUsername");
    const detailMapLink = document.getElementById("detailMapLink");
    const backToHomeFromDetail = document.getElementById("backToHomeFromDetail");
    const commentsList = document.getElementById("commentsList");
    const commentInput = document.getElementById("commentInput");
    const postCommentBtn = document.getElementById("postCommentBtn");

    let currentPostId = null;

    // Helpers
    function showSection(section) {
      // Hide all first
      [mainSection, postDetailSection, uploadSection, profileSection].forEach(
        (sec) => sec.classList.remove("active")
      );
      // Show requested
      section.classList.add("active");

      // Show/hide search bar & header buttons
      if (section === mainSection) {
        searchBar.style.display = "block";
        goToUploadBtn.style.display = "inline-block";
      } else {
        searchBar.style.display = "none";
        goToUploadBtn.style.display = "none";
      }
    }

    // Load posts into grid
    function loadPosts(filter = "") {
      postsGrid.innerHTML = "";
      const filteredPosts = posts.filter((p) =>
        p.title.toLowerCase().includes(filter.toLowerCase())
      );
      filteredPosts.forEach((post) => {
        const card = document.createElement("div");
        card.className = "post-card";
        card.dataset.id = post.id;

        card.innerHTML = `
          <img src="${post.image}" alt="${post.title}" />
          <div class="post-info">
            <h3>${post.title}</h3>
            <div class="user-info">
              <img src="${post.userPic}" alt="Uploader" class="user-pic" />
              <span>${post.username}</span>
            </div>
          </div>
        `;
        card.addEventListener("click", () => {
          openPostDetail(post.id);
        });
        postsGrid.appendChild(card);
      });
    }

    // Open detailed view for post
    function openPostDetail(postId) {
      currentPostId = postId;
      const post = posts.find((p) => p.id === postId);
      if (!post) return;

      detailImage.src = post.image;
      detailTitle.textContent = post.title;
      detailDescription.textContent = post.description;
      detailUserPic.src = post.userPic;
      detailUsername.textContent = post.username;
      detailMapLink.href = post.mapLink || "#";

      // Load comments
      loadComments(post.comments);

      showSection(postDetailSection);
    }

    // Load comments
    function loadComments(comments) {
      commentsList.innerHTML = "";
      if (!comments || comments.length === 0) {
        commentsList.innerHTML = "<p>No comments yet.</p>";
        return;
      }
      comments.forEach((comment) => {
        const div = document.createElement("div");
        div.className = "comment";
        div.textContent = comment;
        commentsList.appendChild(div);
      });
    }

    // Post a new comment
    postCommentBtn.addEventListener("click", () => {
      const comment = commentInput.value.trim();
      if (!comment) return alert("Comment cannot be empty.");
      if (currentPostId == null) return;

      const post = posts.find((p) => p.id === currentPostId);
      if (!post.comments) post.comments = [];
      post.comments.push(comment);
      commentInput.value = "";
      loadComments(post.comments);
    });

    // Search posts
    searchInput.addEventListener("input", () => {
      loadPosts(searchInput.value);
    });

    // Go home button
    homeBtn.addEventListener("click", () => {
      showSection(mainSection);
      currentPostId = null;
      searchInput.value = "";
      loadPosts();
    });

    // Back to home button
    backToHomeFromDetail.addEventListener("click" , () => {
    showSection(mainSection);
    });

    // Upload button -> check profile first
    goToUploadBtn.addEventListener("click", () => {
      if (!currentUser) {
        // Show profile form first
        showSection(profileSection);
      } else {
        // Show upload form directly
        showSection(uploadSection);
      }
    });

    // Profile pic preview
    profilePicInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (ev) => {
          profilePicPreview.src = ev.target.result;
          profilePicPreview.style.display = "block";
        };
        reader.readAsDataURL(file);
      } else {
        profilePicPreview.style.display = "none";
        profilePicPreview.src = "";
      }
    });

    // Save profile form submit
    profileForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const usernameVal = usernameInput.value.trim();
      const file = profilePicInput.files[0];

      if (!usernameVal) {
        alert("Please enter a username.");
        return;
      }
      if (!file) {
        alert("Please select a profile picture.");
        return;
      }

      const reader = new FileReader();
      reader.onload = (ev) => {
        currentUser = {
          username: usernameVal.startsWith("@")
            ? usernameVal
            : "@" + usernameVal,
          profilePicUrl: ev.target.result,
        };
        // Clear form
        profileForm.reset();
        profilePicPreview.style.display = "none";
        profilePicPreview.src = "";

        // Move to upload section
        showSection(uploadSection);
      };
      reader.readAsDataURL(file);
    });

    cancelProfileBtn.addEventListener("click", () => {
      // Cancel profile completion - go home
      profileForm.reset();
      profilePicPreview.style.display = "none";
      profilePicPreview.src = "";
      showSection(mainSection);
    });

    // Image preview for post upload
    imageInput.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (ev) => {
          imagePreview.src = ev.target.result;
          imagePreview.style.display = "block";
        };
        reader.readAsDataURL(file);
      } else {
        imagePreview.style.display = "none";
        imagePreview.src = "";
      }
    });

    // Upload post form submit
    uploadForm.addEventListener("submit", (e) => {
      e.preventDefault();
      if (!currentUser) {
        alert("Please complete your profile first.");
        showSection(profileSection);
        return;
      }
      const title = uploadForm.title.value.trim();
      const description = uploadForm.description.value.trim();
      const location = uploadForm.location.value.trim();
      const file = imageInput.files[0];

      if (!title || !description || !location || !file) {
        alert("Please fill all fields and select an image.");
        return;
      }

      const reader = new FileReader();
      reader.onload = (ev) => {
        const newPost = {
          id: posts.length + 1,
          title,
          description,
          mapLink: location,
          image: ev.target.result,
          username: currentUser.username,
          userPic: currentUser.profilePicUrl,
          comments: [],
        };
        posts.unshift(newPost);
        uploadForm.reset();
        imagePreview.style.display = "none";
        imagePreview.src = "";

        showSection(mainSection);
        loadPosts();
        alert("Post uploaded successfully!");
      };
      reader.readAsDataURL(file);
    });

    cancelUploadBtn.addEventListener("click", () => {
      uploadForm.reset();
      imagePreview.style.display = "none";
      imagePreview.src = "";
      showSection(mainSection);
    });

    // Initial load
    loadPosts();
  </script>
</body>
</html>
